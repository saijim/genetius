---
import type { TrendResult } from '~/lib/trends';

interface Props {
  trends: TrendResult;
}

const { trends } = Astro.props;

const periodLabels = {
  day: 'Last 24 Hours',
  week: 'Last 7 Days',
  month: 'Last 30 Days',
  year: 'Last 365 Days',
};
---

<section class="card bg-base-100 shadow-md">
  <div class="card-body">
    <header class="card-header flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div class="stats stats-horizontal gap-4">
        <div class="stat">
          <div class="stat-value text-primary">{trends.stats.totalPapers}</div>
          <div class="stat-title">Papers</div>
        </div>
        <div class="stat">
          <div class="stat-value text-success">{trends.stats.avgAuthors}</div>
          <div class="stat-title">Avg Authors</div>
        </div>
      </div>
      <h2 class="card-title text-xl">
        {periodLabels[trends.period]} Trends
      </h2>
    </header>

    <div class="grid md:grid-cols-4 gap-6">
      <div>
        <h3 class="text-lg font-semibold mb-3">Model Organisms</h3>
        {trends.organisms.length > 0 ? (
          <ul class="space-y-2">
            {trends.organisms.map((item) => (
              <li class="flex justify-between items-center text-base-content">
                <span class="truncate pr-2" title={item.organism}>{item.organism}</span>
                <span class="badge badge-soft shrink-0">
                  {item.count}
                </span>
              </li>
            ))}
          </ul>
        ) : (
          <p class="text-base-content/50 italic">No data available</p>
        )}
      </div>

      <div>
        <h3 class="text-lg font-semibold mb-3">Top Keywords</h3>
        {trends.keywords.length > 0 ? (
          <ul class="space-y-2">
            {trends.keywords.map((item) => (
              <li class="flex justify-between items-center text-base-content">
                <span class="truncate pr-2" title={item.keyword}>{item.keyword}</span>
                <span class="badge badge-soft shrink-0">
                  {item.count}
                </span>
              </li>
            ))}
          </ul>
        ) : (
          <p class="text-base-content/50 italic">No data available</p>
        )}
      </div>

      <div>
        <h3 class="text-lg font-semibold mb-3">Top Authors</h3>
        {trends.authors.length > 0 ? (
          <ul class="space-y-2">
            {trends.authors.map((item) => (
              <li class="flex justify-between items-center text-base-content">
                <span class="truncate pr-2" title={item.author}>{item.author}</span>
                <span class="badge badge-soft shrink-0">
                  {item.count}
                </span>
              </li>
            ))}
          </ul>
        ) : (
          <p class="text-base-content/50 italic">No data available</p>
        )}
      </div>

      <div>
        <h3 class="text-lg font-semibold mb-3">Paper Types</h3>
        {trends.paperTypes.length > 0 ? (
          <ul class="space-y-2">
            {trends.paperTypes.map((item) => (
              <li class="flex justify-between items-center text-base-content">
                <span class="truncate pr-2" title={item.type}>{item.type}</span>
                <span class="badge badge-soft shrink-0">
                  {item.count}
                </span>
              </li>
            ))}
          </ul>
        ) : (
          <p class="text-base-content/50 italic">No data available</p>
        )}
      </div>
    </div>
  </div>
</section>
